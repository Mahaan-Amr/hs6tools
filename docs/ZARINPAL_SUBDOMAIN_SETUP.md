# راهنمای تنظیم زیردامنه اختصاصی زرین‌پال در Cloudflare

## مقدمه
برای رعایت الزامات شبکه پرداخت شاپرک و افزایش امنیت، زرین‌پال نیاز به تنظیم یک زیردامنه اختصاصی (Subdomain) دارد. این زیردامنه برای نمایش صفحات پرداخت و واسط‌های زرین‌پال با نشانی رسمی دامنه شما استفاده می‌شود.

## مراحل تنظیم

### مرحله 1: تنظیم در پنل زرین‌پال

1. وارد **میز کار زرین‌پال** شوید
2. از منوی سمت راست، گزینه **تنظیمات درگاه** را انتخاب کنید
3. در صفحه باز شده، بخش **تنظیمات فنی** را باز کنید
4. در بخش **زیردامنه اختصاصی**، پیشوند مورد نظر را وارد کنید:
   - پیشنهاد می‌شود از پیشوندهای کوتاه و مرتبط استفاده کنید:
     - `pay`
     - `payment`
     - `shop`
     - `checkout`
5. روی دکمه **ذخیره** کلیک کنید
6. **مقدار CNAME** که به شما نمایش داده می‌شود را کپی کنید (مثلاً: `zarinpal.example.com`)

### مرحله 2: تنظیم CNAME در Cloudflare

#### گام 1: ورود به پنل Cloudflare
1. به [dash.cloudflare.com](https://dash.cloudflare.com) بروید
2. وارد حساب کاربری خود شوید
3. دامنه `hs6tools.com` را از لیست دامنه‌ها انتخاب کنید

#### گام 2: دسترسی به بخش DNS
1. از منوی سمت چپ، روی **DNS** کلیک کنید
2. یا به مسیر: **DNS** → **Records** بروید

#### گام 3: افزودن رکورد CNAME
1. روی دکمه **Add record** کلیک کنید
2. تنظیمات زیر را وارد کنید:

   ```
   Type: CNAME
   Name: pay
   Target: [مقدار CNAME دریافتی از زرین‌پال]
   Proxy status: DNS only (ابر نارنجی باید خاموش باشد)
   TTL: Auto
   ```

3. روی **Save** کلیک کنید

#### نکات مهم:
- ⚠️ **Proxy status باید DNS only باشد** (ابر نارنجی خاموش)
- ⚠️ اگر Proxy روشن باشد، زرین‌پال نمی‌تواند زیردامنه را تأیید کند
- ⚠️ TTL را روی Auto بگذارید
- ⚠️ Name فقط پیشوند است (مثلاً `pay` نه `pay.hs6tools.com`)

### مرحله 3: بررسی و تأیید

1. **انتظار برای انتشار DNS:**
   - معمولاً 5-15 دقیقه طول می‌کشد
   - در برخی موارد تا 24 ساعت ممکن است طول بکشد

2. **بررسی در پنل زرین‌پال:**
   - به بخش **تنظیمات فنی** برگردید
   - وضعیت زیردامنه را بررسی کنید
   - پس از تأیید DNS، وضعیت باید به **«فعال»** تغییر کند

3. **تست دسترسی:**
   - می‌توانید `pay.hs6tools.com` را در مرورگر باز کنید
   - باید صفحه زرین‌پال نمایش داده شود

### عیب‌یابی

#### مشکل: زیردامنه فعال نشده است

**بررسی‌ها:**
1. ✅ مقدار CNAME درست کپی شده باشد
2. ✅ Proxy status در Cloudflare خاموش باشد (DNS only)
3. ✅ رکورد CNAME به درستی ذخیره شده باشد
4. ✅ TTL روی Auto باشد

**راه‌حل:**
- چند دقیقه صبر کنید (DNS propagation)
- رکورد را حذف و دوباره اضافه کنید
- با پشتیبانی زرین‌پال تماس بگیرید

#### مشکل: خطای DNS در Cloudflare

**بررسی‌ها:**
1. ✅ Name فقط پیشوند باشد (نه دامنه کامل)
2. ✅ Target مقدار CNAME دریافتی از زرین‌پال باشد
3. ✅ Type روی CNAME باشد (نه A یا AAAA)

## منابع

- [راهنمای رسمی زرین‌پال](https://www.zarinpal.com/blog/%D8%AA%D9%86%D8%B8%DB%8C%D9%85-%D8%B2%DB%8C%D8%B1-%D8%AF%D8%A7%D9%85%D9%86%D9%87-%D8%A7%D8%AE%D8%AA%D8%B5%D8%A7%D8%B5%DB%8C-%D8%AF%D8%B1-%D8%B2%D8%B1%DB%8C%D9%86%D9%BE%D8%A7%D9%84/)
- [مستندات Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/)

## توصیه برای پروژه HS6Tools

### زیردامنه پیشنهادی: `pay`

**دلایل انتخاب:**
- ✅ کوتاه و حرفه‌ای
- ✅ رایج‌ترین انتخاب برای درگاه‌های پرداخت
- ✅ تداخلی با مسیرهای موجود ندارد:
  - `/checkout` - صفحه تسویه حساب شما
  - `/cart` - سبد خرید
  - `/shop` - فروشگاه
- ✅ واضح و قابل فهم برای کاربران
- ✅ زیردامنه فقط برای صفحات واسط زرین‌پال استفاده می‌شود

**نتیجه نهایی:** `pay.hs6tools.com`

## وضعیت فعلی

- [ ] زیردامنه در پنل زرین‌پال تنظیم شده
- [ ] مقدار CNAME دریافت شده
- [ ] رکورد CNAME در Cloudflare اضافه شده
- [ ] Proxy status خاموش است
- [ ] زیردامنه در پنل زرین‌پال فعال شده
- [ ] تست دسترسی انجام شده

## یادداشت‌ها

- تاریخ تنظیم: [تاریخ]
- مقدار CNAME: [مقدار]
- زیردامنه: `pay.hs6tools.com`
- انتخاب شده بر اساس: عدم تداخل با مسیرهای موجود و استانداردهای صنعتی

